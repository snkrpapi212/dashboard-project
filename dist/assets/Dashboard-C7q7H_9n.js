import{j as e,T as Oe,u as Be}from"./index-CiWu5Xlx.js";import{r as i,R as Z,L as We,C as ce,X as J,Y as X,T as ee,b as te,c as Ce,d as ze,A as Ke,e as He,B as Ge,f as Ve,g as ye,S as Ue,P as Ye,h as qe}from"./recharts-vendor-FwUuIb9n.js";import{u as Qe,g as Je,a as Xe,b as Ze,c as et,f as ke,d as tt}from"./table-vendor-JD6bCq3q.js";function at({value:t,max:a=100,variant:s="default",size:r="md",indeterminate:n=!1,label:l,showValue:d=!1,description:c,ariaLabel:m}){const g=Math.min(100,Math.max(0,t/a*100)),u=Math.round(g),b=l||d,h=b||c,j=e.jsx("div",{className:`progress-bar progress-bar--${r}${n?" progress-bar--indeterminate":""}`,role:"progressbar","aria-valuenow":n?void 0:u,"aria-valuemin":0,"aria-valuemax":100,"aria-label":m||l||"Progress",children:e.jsx("div",{className:`progress-bar__fill progress-bar__fill--${s}`,style:n?void 0:{width:`${g}%`}})});return h?e.jsxs("div",{className:"progress-bar-wrapper",children:[b&&e.jsxs("div",{className:"progress-bar-wrapper__header",children:[l&&e.jsx("span",{className:"progress-bar-wrapper__label",children:l}),d&&!n&&e.jsxs("span",{className:"progress-bar-wrapper__value",children:[u,"%"]})]}),j,c&&e.jsx("span",{className:"progress-bar-wrapper__description",children:c})]}):j}const st={sm:24,md:40,lg:56};function rt({value:t,max:a=100,variant:s="default",size:r="md",indeterminate:n=!1,showLabel:l=!1,ariaLabel:d}){const c=st[r],m=(c-6)/2,g=2*Math.PI*m,u=Math.min(100,Math.max(0,t/a*100)),b=g-u/100*g,h=Math.round(u),j=s!=="default"?` progress-circular__fill--${s}`:"";return e.jsxs("div",{className:`progress-circular progress-circular--${r}${n?" progress-circular--indeterminate":""}`,role:"progressbar","aria-valuenow":n?void 0:h,"aria-valuemin":0,"aria-valuemax":100,"aria-label":d||"Progress",children:[e.jsxs("svg",{className:"progress-circular__svg",viewBox:`0 0 ${c} ${c}`,children:[e.jsx("circle",{className:"progress-circular__track",cx:c/2,cy:c/2,r:m}),e.jsx("circle",{className:`progress-circular__fill${j}`,cx:c/2,cy:c/2,r:m,strokeDasharray:g,strokeDashoffset:n?void 0:b})]}),l&&!n&&r!=="sm"&&e.jsxs("span",{className:"progress-circular__label",children:[h,"%"]})]})}const nt={danger:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[e.jsx("path",{d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),e.jsx("path",{d:"M8 8l8 8M16 8l-8 8",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),warning:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[e.jsx("path",{d:"M12 3L1.5 21h21L12 3z",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round",fill:"none"}),e.jsx("path",{d:"M12 10v4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("circle",{cx:"12",cy:"17",r:"0.75",fill:"currentColor"})]}),info:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[e.jsx("path",{d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),e.jsx("path",{d:"M12 11v5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("circle",{cx:"12",cy:"8",r:"0.75",fill:"currentColor"})]})};function it({isOpen:t,onClose:a,title:s,description:r,variant:n="danger",confirmLabel:l="Confirm",cancelLabel:d="Cancel",onConfirm:c,onCancel:m}){const[g,u]=i.useState(!1),[b,h]=i.useState(!1),j=i.useRef(null),f=i.useRef(null);i.useEffect(()=>{t&&(f.current=document.activeElement,u(!1))},[t]),i.useEffect(()=>{t&&j.current&&j.current.querySelector(".dialog__btn--cancel")?.focus()},[t]);const _=i.useCallback(()=>{u(!0),setTimeout(()=>{a(),u(!1),f.current?.focus()},150)},[a]),x=i.useCallback(async()=>{h(!0);try{await c(),_()}catch{}finally{h(!1)}},[c,_]),v=i.useCallback(()=>{m?.(),_()},[m,_]),C=i.useCallback(y=>{if(y.key==="Escape"){y.preventDefault(),v();return}if(y.key==="Tab"&&j.current){const p=j.current.querySelectorAll('button:not([disabled]), [tabindex]:not([tabindex="-1"])'),w=p[0],o=p[p.length-1];y.shiftKey&&document.activeElement===w?(y.preventDefault(),o?.focus()):!y.shiftKey&&document.activeElement===o&&(y.preventDefault(),w?.focus())}},[v]);return t?e.jsx("div",{className:`dialog-overlay${g?" dialog-overlay--exiting":""}`,onClick:y=>{y.target===y.currentTarget&&v()},onKeyDown:C,role:"presentation",children:e.jsxs("div",{ref:j,className:`dialog${g?" dialog--exiting":""}`,role:"alertdialog","aria-modal":"true","aria-labelledby":"dialog-title","aria-describedby":"dialog-description",children:[e.jsx("div",{className:`dialog__icon dialog__icon--${n}`,children:nt[n]}),e.jsx("h2",{id:"dialog-title",className:"dialog__title",children:s}),e.jsx("p",{id:"dialog-description",className:"dialog__description",children:r}),e.jsxs("div",{className:"dialog__actions",children:[e.jsx("button",{className:"dialog__btn dialog__btn--cancel",onClick:v,disabled:b,children:d}),e.jsx("button",{className:`dialog__btn ${n==="danger"?"dialog__btn--danger":"dialog__btn--confirm"}`,onClick:x,disabled:b,children:b?"Processing...":l})]})]})}):null}function pe(t){const[a,s]=i.useState(()=>typeof window>"u"?!1:window.matchMedia(t).matches);return i.useEffect(()=>{const r=window.matchMedia(t),n=l=>{s(l.matches)};return s(r.matches),r.addEventListener("change",n),()=>r.removeEventListener("change",n)},[t]),a}const lt="(min-width: 1024px)",ot="(min-width: 768px)";function ct({children:t,navItems:a=[],headerRight:s,title:r="Sales Dashboard",activePath:n="/",onNavigate:l,sidebarCollapsed:d,onSidebarCollapsedChange:c}){const m=pe(lt),g=pe(ot),[u,b]=i.useState(!1),[h,j]=i.useState(!1),[f,_]=i.useState(new Set),x=d??u,v=i.useCallback(k=>{c?c(k):b(k)},[c]);i.useEffect(()=>{!m&&g&&v(!0),g||j(!1)},[m,g,v]),i.useEffect(()=>{const k=S=>{S.key==="Escape"&&h&&j(!1)};return document.addEventListener("keydown",k),()=>document.removeEventListener("keydown",k)},[h]);const C=i.useCallback(()=>{g?v(!x):j(k=>!k)},[g,x,v]),y=i.useCallback(k=>{_(S=>{const P=new Set(S);return P.has(k)?P.delete(k):P.add(k),P})},[]),p=i.useCallback((k,S)=>{if(k.children&&k.children.length>0){S.preventDefault(),y(k.id);return}l&&(S.preventDefault(),l(k.href)),g||j(!1)},[l,y,g]),w=["layout-sidebar",x?"layout-sidebar--collapsed":"",h?"layout-sidebar--mobile-open":""].filter(Boolean).join(" "),o=["app-shell",x?"app-shell--sidebar-collapsed":""].filter(Boolean).join(" ");return e.jsxs("div",{className:o,children:[e.jsx("a",{href:"#main-content",className:"skip-link",children:"Skip to main content"}),e.jsx("a",{href:"#sidebar-nav",className:"skip-link",children:"Skip to navigation"}),e.jsxs("header",{className:"layout-header",role:"banner",children:[e.jsxs("div",{className:"layout-header__left",children:[e.jsxs("button",{className:"sidebar-toggle",onClick:C,"aria-label":h||!x?"Collapse sidebar":"Expand sidebar","aria-expanded":h||!x,children:[e.jsx("span",{className:"sidebar-toggle__line"}),e.jsx("span",{className:"sidebar-toggle__line"}),e.jsx("span",{className:"sidebar-toggle__line"})]}),e.jsx("h1",{className:"layout-header__title",children:r})]}),e.jsx("div",{className:"layout-header__right",children:s})]}),e.jsx("div",{className:`mobile-overlay ${h?"mobile-overlay--visible":""}`,onClick:()=>j(!1),"aria-hidden":"true"}),e.jsx("aside",{id:"sidebar-nav",className:w,role:"navigation","aria-label":"Main navigation",children:e.jsx("nav",{className:"sidebar-nav",children:e.jsx("ul",{className:"sidebar-nav__list",role:"list",children:a.map(k=>e.jsx(we,{item:k,activePath:n,isCollapsed:x&&g,expandedGroups:f,onNavClick:p},k.id))})})}),e.jsx("main",{id:"main-content",className:"layout-main",role:"main",children:e.jsx("div",{className:"layout-main__content",children:t})})]})}function we({item:t,activePath:a,isCollapsed:s,expandedGroups:r,onNavClick:n,depth:l=0}){const d=a===t.href,c=t.children&&t.children.length>0,m=r.has(t.id),g=["sidebar-nav__item",d?"sidebar-nav__item--active":""].filter(Boolean).join(" ");return e.jsxs("li",{role:"none",children:[e.jsxs("a",{href:t.href,className:g,onClick:u=>n(t,u),"aria-current":d?"page":void 0,"aria-expanded":c?m:void 0,title:s?t.label:void 0,children:[t.icon&&e.jsx("span",{className:"sidebar-nav__item-icon","aria-hidden":"true",children:t.icon}),e.jsx("span",{className:"sidebar-nav__item-label",children:t.label}),t.badge!=null&&t.badge>0&&e.jsx("span",{className:"sidebar-nav__item-badge","aria-label":`${t.badge} new`,children:t.badge}),c&&e.jsx("span",{className:`sidebar-nav__item-chevron ${m?"sidebar-nav__item-chevron--expanded":""}`,"aria-hidden":"true",children:"›"})]}),c&&m&&e.jsx("ul",{className:"sidebar-nav__submenu",role:"group",children:t.children.map(u=>e.jsx(we,{item:u,activePath:a,isCollapsed:s,expandedGroups:r,onNavClick:n,depth:l+1},u.id))})]})}function dt({filterBar:t,kpiCards:a,charts:s,dataTable:r,children:n}){return e.jsxs("div",{className:"dashboard-grid",children:[t&&e.jsx("section",{className:"dashboard-grid__filter-bar","aria-label":"Dashboard filters",children:t}),a&&e.jsx("section",{className:"dashboard-grid__kpi-row","aria-label":"Key performance indicators",children:a}),s&&e.jsx("section",{className:"dashboard-grid__chart-area","aria-label":"Charts and visualizations",children:s}),r&&e.jsx("section",{className:"dashboard-grid__table-section","aria-label":"Data table",children:r}),n]})}function de(){const t=new Date,a=new Date;return a.setDate(a.getDate()-30),{start:a,end:t,preset:"30d"}}const Se={dateRange:de(),categories:[],regions:[],search:"",comparison:{enabled:!1,period:"previous"},granularity:"day"};function ut(t){const a=new Date,s=new Date;switch(t){case"today":s.setHours(0,0,0,0);break;case"7d":s.setDate(s.getDate()-7);break;case"30d":s.setDate(s.getDate()-30);break;case"90d":s.setDate(s.getDate()-90);break;case"quarter":s.setMonth(s.getMonth()-3);break;case"year":s.setFullYear(s.getFullYear()-1);break;default:s.setDate(s.getDate()-30)}return{start:s,end:a,preset:t}}function ht(t,a){switch(a.type){case"SET_DATE_RANGE":return{...t,dateRange:a.payload};case"SET_DATE_PRESET":return{...t,dateRange:ut(a.payload)};case"SET_CATEGORIES":return{...t,categories:a.payload};case"TOGGLE_CATEGORY":{const s=a.payload,r=t.categories.includes(s)?t.categories.filter(n=>n!==s):[...t.categories,s];return{...t,categories:r}}case"SET_REGIONS":return{...t,regions:a.payload};case"SET_SEARCH":return{...t,search:a.payload};case"SET_COMPARISON":return{...t,comparison:a.payload};case"SET_GRANULARITY":return{...t,granularity:a.payload};case"RESET_FILTERS":return{...Se,dateRange:de()};default:return t}}const Ne=i.createContext(null);function gt({children:t,defaultFilters:a,defaultAutoRefresh:s=!0,defaultRefreshInterval:r=3e4}){const n={...Se,...a,dateRange:a?.dateRange??de()},[l,d]=i.useReducer(ht,n),[c,m]=i.useState(s),[g,u]=i.useState(r),[b,h]=i.useState(Date.now()),j=i.useMemo(()=>{let o=0;return l.dateRange.preset!=="30d"&&o++,o+=l.categories.length,o+=l.regions.length,l.search&&o++,l.comparison.enabled&&o++,l.granularity!=="day"&&o++,o},[l]),f=i.useCallback(o=>d({type:"SET_DATE_RANGE",payload:o}),[]),_=i.useCallback(o=>d({type:"SET_DATE_PRESET",payload:o}),[]),x=i.useCallback(o=>d({type:"SET_CATEGORIES",payload:o}),[]),v=i.useCallback(o=>d({type:"TOGGLE_CATEGORY",payload:o}),[]),C=i.useCallback(o=>d({type:"SET_SEARCH",payload:o}),[]),y=i.useCallback(()=>d({type:"RESET_FILTERS"}),[]),p=i.useCallback(()=>{h(Date.now())},[]);i.useEffect(()=>{try{const o={...l,dateRange:{start:l.dateRange.start.toISOString(),end:l.dateRange.end.toISOString(),preset:l.dateRange.preset}};localStorage.setItem("dashboard-filters",JSON.stringify(o))}catch{}},[l]);const w={filters:l,dispatch:d,setDateRange:f,setDatePreset:_,setCategories:x,toggleCategory:v,setSearch:C,resetFilters:y,activeFilterCount:j,autoRefresh:c,setAutoRefresh:m,refreshInterval:g,setRefreshInterval:u,lastRefreshed:b,triggerRefresh:p};return e.jsx(Ne.Provider,{value:w,children:t})}function Re(){const t=i.useContext(Ne);if(!t)throw new Error("useDashboard must be used within a DashboardProvider");return t}const De="dashboard-theme",mt="data-theme",Te=["light","dark","high-contrast"],Ee=i.createContext({theme:"light",setTheme:()=>{},toggleTheme:()=>{},isDark:!1});function pt(){return typeof window>"u"?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function fe(){if(typeof window>"u")return null;const t=localStorage.getItem(De);return t&&Te.includes(t)?t:null}function ft({children:t,defaultTheme:a}){const[s,r]=i.useState(()=>fe()??a??pt());i.useEffect(()=>{document.documentElement.setAttribute(mt,s),localStorage.setItem(De,s)},[s]),i.useEffect(()=>{const c=window.matchMedia("(prefers-color-scheme: dark)"),m=g=>{fe()||r(g.matches?"dark":"light")};return c.addEventListener("change",m),()=>c.removeEventListener("change",m)},[]);const n=i.useCallback(c=>{Te.includes(c)&&r(c)},[]),l=i.useCallback(()=>{r(c=>c==="dark"?"light":"dark")},[]),d=s==="dark";return e.jsx(Ee.Provider,{value:{theme:s,setTheme:n,toggleTheme:l,isDark:d},children:t})}function xt(){const t=i.useContext(Ee);if(!t)throw new Error("useTheme must be used within a ThemeProvider");return t}function Y(t){return typeof window>"u"?"":getComputedStyle(document.documentElement).getPropertyValue(t).trim()}function bt(t=8){const a=[];for(let s=1;s<=t;s++){const r=Y(`--chart-color-${s}`);r&&a.push(r)}return a}const _t=i.createContext(null);function vt({children:t,defaultCollapsed:a=!1}){const[s,r]=i.useState(a),[n,l]=i.useState(!1),d=i.useCallback(()=>{r(u=>!u)},[]),c=i.useCallback(u=>{r(u)},[]),m=i.useCallback(()=>{l(u=>!u)},[]),g=i.useCallback(u=>{l(u)},[]);return e.jsx(_t.Provider,{value:{isCollapsed:s,toggleCollapsed:d,setCollapsed:c,isMobileOpen:n,toggleMobileOpen:m,setMobileOpen:g},children:t})}function jt({children:t,defaultAutoRefresh:a=!0,defaultRefreshInterval:s=3e4}){return e.jsx(ft,{children:e.jsx(vt,{children:e.jsx(gt,{defaultAutoRefresh:a,defaultRefreshInterval:s,children:e.jsx(Oe,{children:t})})})})}function $e(t,a=2){if(t===0)return"0";const s=Math.abs(t),r=t<0?"-":"";return s>=1e9?`${r}${(s/1e9).toFixed(a)}B`:s>=1e6?`${r}${(s/1e6).toFixed(a)}M`:s>=1e3?`${r}${(s/1e3).toFixed(a)}K`:`${r}${s.toFixed(a)}`}function ue(t,a={}){const{currency:s="USD",compact:r=!1,decimals:n}=a;return r?`${s==="USD"?"$":""}${$e(t,n??1)}`:new Intl.NumberFormat("en-US",{style:"currency",currency:s,minimumFractionDigits:n??0,maximumFractionDigits:n??0}).format(t)}function he(t,a={}){const{showSign:s=!1,decimals:r=1}=a,n=t.toFixed(r);return`${s&&t>0?"+":""}${n}%`}function Me(t,a={}){const{decimals:s=0,compact:r=!1}=a;return r?$e(t,s):new Intl.NumberFormat("en-US",{minimumFractionDigits:s,maximumFractionDigits:s}).format(t)}function Ct(t,a=2){return t.toFixed(a)}function yt(t,a="medium"){const s=typeof t=="string"?new Date(t):t,r={short:{month:"numeric",day:"numeric"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"}}[a];return s.toLocaleDateString("en-US",r)}function kt(t,a,s=!0){switch(a){case"currency":return ue(t,{compact:s});case"percentage":return he(t);case"decimal":return Ct(t);case"number":default:return Me(t,{compact:s})}}const wt={positive:"kpi-icon--success",negative:"kpi-icon--danger",neutral:"kpi-icon--primary",warning:"kpi-icon--warning"},St={up:"↑",down:"↓",neutral:"→"};function Nt({data:t,status:a,width:s=100,height:r=32}){if(!t||t.length<2)return null;const n=Math.min(...t),d=Math.max(...t)-n||1,c=t.map((g,u)=>{const b=u/(t.length-1)*s,h=r-(g-n)/d*r;return`${b},${h}`}).join(" "),m=a==="positive"?"var(--kpi-trend-positive)":a==="negative"?"var(--kpi-trend-negative)":"var(--kpi-trend-neutral)";return e.jsx("svg",{className:"kpi-card__sparkline",viewBox:`0 0 ${s} ${r}`,preserveAspectRatio:"none","aria-hidden":"true",role:"img",children:e.jsx("polyline",{points:c,fill:"none",stroke:m,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}function Rt({data:t,onClick:a,loading:s=!1,compact:r=!1}){const{label:n,value:l,trend:d,trendDirection:c,status:m,format:g,sparkline:u,icon:b,comparisonLabel:h="vs last period",target:j}=t;if(s)return e.jsx(Dt,{});const f=`kpi-card__trend kpi-card__trend--${m}`,_=`kpi-card__icon ${wt[m]}`,x=["kpi-card",r?"kpi-card--compact":"",a?"kpi-card--clickable":""].filter(Boolean).join(" "),v=kt(l,g),C=he(Math.abs(d),{showSign:!1}),y=j?Math.min(l/j*100,100):null;return e.jsxs("article",{className:x,onClick:a?()=>a(t):void 0,role:a?"button":void 0,tabIndex:a?0:void 0,onKeyDown:a?p=>{(p.key==="Enter"||p.key===" ")&&(p.preventDefault(),a(t))}:void 0,"aria-label":`${n}: ${v}, ${c} ${C}`,children:[e.jsxs("div",{className:"kpi-card__header",children:[e.jsx("span",{className:"kpi-card__label",children:n}),b&&e.jsx("span",{className:_,"aria-hidden":"true",children:b})]}),e.jsx("div",{className:"kpi-card__value",children:v}),e.jsxs("div",{className:f,children:[e.jsx("span",{className:"kpi-card__trend-arrow","aria-hidden":"true",children:St[c]}),e.jsx("span",{className:"kpi-card__trend-value",children:C}),e.jsx("span",{className:"kpi-card__comparison",children:h})]}),y!==null&&e.jsxs("div",{className:"kpi-card__progress",children:[e.jsx("div",{className:"kpi-card__progress-bar",children:e.jsx("div",{className:"kpi-card__progress-fill",style:{width:`${y}%`},role:"progressbar","aria-valuenow":y,"aria-valuemin":0,"aria-valuemax":100})}),e.jsxs("span",{className:"kpi-card__progress-label",children:[y.toFixed(0),"% of target"]})]}),u&&u.length>0&&e.jsx(Nt,{data:u,status:m})]})}function Dt(){return e.jsxs("div",{className:"kpi-card kpi-card--skeleton","aria-busy":"true","aria-label":"Loading metric",children:[e.jsxs("div",{className:"kpi-card__header",children:[e.jsx("span",{className:"skeleton skeleton--text skeleton--w-50"}),e.jsx("span",{className:"skeleton skeleton--circle skeleton--sm"})]}),e.jsx("div",{className:"skeleton skeleton--text skeleton--w-75 skeleton--lg"}),e.jsx("div",{className:"skeleton skeleton--text skeleton--w-40"}),e.jsx("div",{className:"skeleton skeleton--rect skeleton--sparkline"})]})}const Tt=["#3B82F6","#10B981","#F59E0B","#8B5CF6","#EC4899","#14B8A6","#F97316","#6366F1"];function ae(t=8){const[a,s]=i.useState(()=>le(t));return i.useEffect(()=>{const r=new MutationObserver(()=>{requestAnimationFrame(()=>{s(le(t))})});return r.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),s(le(t)),()=>r.disconnect()},[t]),a}function le(t){const a=bt(t),s=a.length>=t?a:[...a,...Tt].slice(0,t);return{colors:s,getColor:n=>s[n%s.length],gridColor:Y("--chart-grid-color")||"#f3f4f6",axisColor:Y("--chart-axis-color")||"#d1d5db",axisTextColor:Y("--chart-axis-text-color")||"#9ca3af",tooltipBg:Y("--chart-tooltip-bg")||"#111827",tooltipText:Y("--chart-tooltip-text")||"#ffffff",cardBg:Y("--card-bg")||"#ffffff"}}function se({active:t,payload:a,label:s,formatType:r="default",valueFormatter:n,labelFormatter:l}){if(!t||!a||a.length===0)return null;const d=l?l(String(s)):String(s);return e.jsxs("div",{className:"recharts-custom-tooltip",role:"tooltip",children:[e.jsx("p",{className:"recharts-custom-tooltip__label",children:d}),e.jsx("ul",{className:"recharts-custom-tooltip__list",children:a.map((c,m)=>{const g=c.value,u=n?n(g):Et(g,r);return e.jsxs("li",{className:"recharts-custom-tooltip__item",children:[e.jsx("span",{className:"recharts-custom-tooltip__dot",style:{backgroundColor:c.color},"aria-hidden":"true"}),e.jsx("span",{className:"recharts-custom-tooltip__name",children:c.name}),e.jsx("span",{className:"recharts-custom-tooltip__value",children:u})]},m)})})]})}function Et(t,a){switch(a){case"currency":return ue(t);case"number":return Me(t);case"percentage":return he(t);default:return typeof t=="number"?t.toLocaleString():String(t)}}function re({title:t,description:a,data:s,columns:r,dataKeys:n,formatters:l={},children:d,className:c="",showTableToggle:m=!0}){const g=i.useId(),u=`${g}-label`,b=`${g}-desc`,h=`${g}-table`,j=`${g}-live`,[f,_]=i.useState(!1),[x,v]=i.useState(!1);i.useEffect(()=>{const p=window.matchMedia("(prefers-reduced-motion: reduce)");v(p.matches);const w=o=>v(o.matches);return p.addEventListener("change",w),()=>p.removeEventListener("change",w)},[]);const C=i.useCallback(()=>{_(p=>!p)},[]),y=i.useCallback((p,w)=>l[p]?l[p](w):typeof w=="number"?w.toLocaleString():String(w??""),[l]);return e.jsxs("figure",{className:`accessible-chart ${c}`.trim(),role:"img","aria-labelledby":u,"aria-describedby":a?b:void 0,"data-reduced-motion":x?"true":void 0,children:[e.jsx("figcaption",{className:"sr-only",id:u,children:t}),a&&e.jsx("p",{className:"sr-only",id:b,children:a}),e.jsxs("div",{id:j,className:"sr-only","aria-live":"polite","aria-atomic":"true",role:"status",children:[t,": ",s.length," data points"]}),e.jsx("div",{className:"accessible-chart__visual",children:d}),m&&e.jsx("div",{className:"accessible-chart__controls",children:e.jsx("button",{className:"accessible-chart__table-toggle",onClick:C,"aria-expanded":f,"aria-controls":h,children:f?"Hide data table":"Show data table"})}),f&&e.jsx("div",{className:"accessible-chart__table-container",id:h,children:e.jsxs("table",{className:"accessible-chart__table",role:"table",children:[e.jsxs("caption",{className:"sr-only",children:[t," - Data Table"]}),e.jsx("thead",{children:e.jsx("tr",{children:r.map((p,w)=>e.jsx("th",{scope:"col",children:p},w))})}),e.jsx("tbody",{children:s.map((p,w)=>e.jsx("tr",{children:n.map((o,k)=>e.jsx("td",{children:y(o,p[o])},k))},w))})]})})]})}function $t(t){const a=["solid","dashed","dotted","dash-dot","long-dash"];return a[t%a.length]}function Mt(t){switch(t){case"solid":return"none";case"dashed":return"8 4";case"dotted":return"2 4";case"dash-dot":return"8 4 2 4";case"long-dash":return"16 6";default:return"none"}}function xe({data:t,series:a,xAxisKey:s,height:r=300,showGrid:n=!0,showLegend:l=!0,formatType:d="default",valueFormatter:c,labelFormatter:m,title:g="Line Chart",description:u,usePatterns:b=!0,animate:h=!0,referenceLine:j,onDataPointClick:f}){const _=ae(a.length),x=i.useCallback((p,w)=>{f?.(p,w)},[f]),v=[s,...a.map(p=>p.name)],C=[s,...a.map(p=>p.dataKey)],y={};return c&&a.forEach(p=>{y[p.dataKey]=c}),e.jsx(re,{title:g,description:u,data:t,columns:v,dataKeys:C,formatters:y,children:e.jsx(Z,{width:"100%",height:r,children:e.jsxs(We,{data:t,margin:{top:8,right:16,left:0,bottom:0},onClick:p=>{p?.activePayload&&f&&x(p.activePayload[0]?.payload,p.activeTooltipIndex??0)},children:[n&&e.jsx(ce,{strokeDasharray:"3 3",stroke:_.gridColor,vertical:!1}),e.jsx(J,{dataKey:s,stroke:_.axisColor,tick:{fill:_.axisTextColor,fontSize:12},tickLine:!1,axisLine:{stroke:_.axisColor}}),e.jsx(X,{stroke:_.axisColor,tick:{fill:_.axisTextColor,fontSize:12},tickLine:!1,axisLine:!1,tickFormatter:c}),e.jsx(ee,{content:e.jsx(se,{formatType:d,valueFormatter:c,labelFormatter:m})}),l&&e.jsx(te,{wrapperStyle:{paddingTop:16,fontSize:12}}),j&&e.jsx(Ce,{y:j.value,stroke:j.color||_.getColor(a.length),strokeDasharray:"8 4",label:{value:j.label,fill:_.axisTextColor,fontSize:11}}),a.map((p,w)=>{const o=p.color||_.getColor(w),k=b?$t(w):"solid",S=Mt(k);return e.jsx(ze,{type:"monotone",dataKey:p.dataKey,name:p.name,stroke:o,strokeWidth:2,strokeDasharray:S!=="none"?S:void 0,dot:{r:3,fill:o,strokeWidth:0},activeDot:{r:6,fill:o,stroke:_.cardBg,strokeWidth:2},isAnimationActive:h,animationDuration:800,animationEasing:"ease-out"},p.dataKey)})]})})})}function At({data:t,series:a,xAxisKey:s,height:r=300,showGrid:n=!0,showLegend:l=!0,stacked:d=!1,formatType:c="default",valueFormatter:m,labelFormatter:g,title:u="Area Chart",description:b,animate:h=!0,fillOpacity:j=.15,referenceLine:f,onDataPointClick:_}){const x=ae(a.length),v=i.useId(),C=i.useCallback((o,k)=>{_?.(o,k)},[_]),y=[s,...a.map(o=>o.name)],p=[s,...a.map(o=>o.dataKey)],w={};return m&&a.forEach(o=>{w[o.dataKey]=m}),e.jsx(re,{title:u,description:b,data:t,columns:y,dataKeys:p,formatters:w,children:e.jsx(Z,{width:"100%",height:r,children:e.jsxs(Ke,{data:t,margin:{top:8,right:16,left:0,bottom:0},onClick:o=>{o?.activePayload&&_&&C(o.activePayload[0]?.payload,o.activeTooltipIndex??0)},children:[e.jsx("defs",{children:a.map((o,k)=>{const S=o.color||x.getColor(k),P=`${v}-gradient-${k}`;return e.jsxs("linearGradient",{id:P,x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:S,stopOpacity:j*2.5}),e.jsx("stop",{offset:"95%",stopColor:S,stopOpacity:.02})]},P)})}),n&&e.jsx(ce,{strokeDasharray:"3 3",stroke:x.gridColor,vertical:!1}),e.jsx(J,{dataKey:s,stroke:x.axisColor,tick:{fill:x.axisTextColor,fontSize:12},tickLine:!1,axisLine:{stroke:x.axisColor}}),e.jsx(X,{stroke:x.axisColor,tick:{fill:x.axisTextColor,fontSize:12},tickLine:!1,axisLine:!1,tickFormatter:m}),e.jsx(ee,{content:e.jsx(se,{formatType:c,valueFormatter:m,labelFormatter:g})}),l&&e.jsx(te,{wrapperStyle:{paddingTop:16,fontSize:12}}),f&&e.jsx(Ce,{y:f.value,stroke:f.color||x.getColor(a.length),strokeDasharray:"8 4",label:{value:f.label,fill:x.axisTextColor,fontSize:11}}),a.map((o,k)=>{const S=o.color||x.getColor(k),P=`${v}-gradient-${k}`;return e.jsx(He,{type:"monotone",dataKey:o.dataKey,name:o.name,stroke:S,strokeWidth:2,fill:`url(#${P})`,fillOpacity:1,stackId:d?"stack":void 0,dot:!1,activeDot:{r:5,fill:S,stroke:x.cardBg,strokeWidth:2},isAnimationActive:h,animationDuration:800,animationEasing:"ease-out"},o.dataKey)})]})})})}function Lt({data:t,series:a,xAxisKey:s,height:r=300,showGrid:n=!0,showLegend:l=!0,stacked:d=!1,horizontal:c=!1,formatType:m="default",valueFormatter:g,labelFormatter:u,title:b="Bar Chart",description:h,animate:j=!0,barRadius:f=4,barGap:_=.1,onBarClick:x}){const v=ae(a.length),[C,y]=i.useState(null),p=i.useCallback((E,O,$)=>{x?.(E,O,$)},[x]),w=[s,...a.map(E=>E.name)],o=[s,...a.map(E=>E.dataKey)],k={};g&&a.forEach(E=>{k[E.dataKey]=g});const S=Ge,P=c?e.jsx(X,{type:"category",dataKey:s,stroke:v.axisColor,tick:{fill:v.axisTextColor,fontSize:12},tickLine:!1,axisLine:!1,width:120}):e.jsx(J,{dataKey:s,stroke:v.axisColor,tick:{fill:v.axisTextColor,fontSize:12},tickLine:!1,axisLine:{stroke:v.axisColor},interval:0,angle:t.length>6?-35:0,textAnchor:t.length>6?"end":"middle",height:t.length>6?60:30}),z=c?e.jsx(J,{type:"number",stroke:v.axisColor,tick:{fill:v.axisTextColor,fontSize:12},tickLine:!1,axisLine:!1,tickFormatter:g}):e.jsx(X,{stroke:v.axisColor,tick:{fill:v.axisTextColor,fontSize:12},tickLine:!1,axisLine:!1,tickFormatter:g});return e.jsx(re,{title:b,description:h,data:t,columns:w,dataKeys:o,formatters:k,children:e.jsx(Z,{width:"100%",height:r,children:e.jsxs(S,{data:t,layout:c?"vertical":"horizontal",margin:{top:8,right:16,left:0,bottom:t.length>6&&!c?24:0},barGap:_,children:[n&&e.jsx(ce,{strokeDasharray:"3 3",stroke:v.gridColor,horizontal:!c,vertical:c}),P,z,e.jsx(ee,{content:e.jsx(se,{formatType:m,valueFormatter:g,labelFormatter:u}),cursor:{fill:v.gridColor,opacity:.3}}),l&&e.jsx(te,{wrapperStyle:{paddingTop:16,fontSize:12}}),a.map((E,O)=>{const $=E.color||v.getColor(O),B=d?O===a.length-1?[f,f,0,0]:[0,0,0,0]:[f,f,0,0];return e.jsx(Ve,{dataKey:E.dataKey,name:E.name,fill:$,stackId:d?"stack":void 0,radius:c?[0,f,f,0]:B,isAnimationActive:j,animationDuration:600,animationEasing:"ease-out",cursor:x?"pointer":void 0,onClick:(R,N)=>p(R,N,E.dataKey),onMouseEnter:(R,N)=>y(N),onMouseLeave:()=>y(null),children:t.map((R,N)=>e.jsx(ye,{fill:$,opacity:C!==null&&C!==N?.5:.85},N))},E.dataKey)})]})})})}function Pt({data:t,series:a,labelKey:s,height:r=300,showLegend:n=!0,donut:l=!1,formatType:d="default",valueFormatter:c,title:m="Pie Chart",description:g,animate:u=!0,showLabels:b=!0,showPercentage:h=!0,onSliceClick:j}){const _=ae(8),[x,v]=i.useState(void 0),C=a[0]?.dataKey;if(!C)return null;let y=[...t];if(y.length>8){const R=y.slice(0,7),T=y.slice(7).reduce((F,W)=>F+(Number(W[C])||0),0);y=[...R,{[s]:"Other",[C]:T}]}const p=y.reduce((R,N)=>R+(Number(N[C])||0),0),w=i.useCallback((R,N)=>{j?.(R,N)},[j]),o=i.useCallback((R,N)=>{v(N)},[]),k=i.useCallback(()=>{v(void 0)},[]),S=i.useCallback(R=>{if(!b)return null;const{cx:N,cy:T,midAngle:F,outerRadius:W,index:H,value:D}=R,M=Math.PI/180,V=W+20,G=N+V*Math.cos(-F*M),U=T+V*Math.sin(-F*M),q=p>0?(D/p*100).toFixed(1):"0",ne=String(y[H]?.[s]??"");return p>0&&D/p<.05?null:e.jsxs("text",{x:G,y:U,fill:_.axisTextColor,textAnchor:G>N?"start":"end",dominantBaseline:"central",fontSize:11,children:[ne,h?` (${q}%)`:""]})},[y,_.axisTextColor,s,b,h,p]),P=i.useCallback(R=>{const{cx:N,cy:T,innerRadius:F,outerRadius:W,startAngle:H,endAngle:D,fill:M,payload:V,value:G}=R,U=p>0?(G/p*100).toFixed(1):"0";return e.jsxs("g",{children:[e.jsx(Ue,{cx:N,cy:T,innerRadius:F,outerRadius:W+6,startAngle:H,endAngle:D,fill:M}),l&&e.jsxs(e.Fragment,{children:[e.jsx("text",{x:N,y:T-8,textAnchor:"middle",fill:_.axisTextColor,fontSize:14,fontWeight:"600",children:V[s]}),e.jsxs("text",{x:N,y:T+12,textAnchor:"middle",fill:_.axisTextColor,fontSize:12,children:[U,"%"]})]})]})},[_.axisTextColor,l,s,p]),z=[s,a[0]?.name||"Value","Percentage"],E=[s,C,"__percent__"],O=y.map(R=>({...R,__percent__:p>0?`${(Number(R[C])/p*100).toFixed(1)}%`:"0%"})),$=l?"55%":0,B="80%";return e.jsx(re,{title:m,description:g,data:O,columns:z,dataKeys:E,formatters:c?{[C]:c}:{},children:e.jsx(Z,{width:"100%",height:r,children:e.jsxs(Ye,{children:[e.jsx(qe,{data:y,dataKey:C,nameKey:s,cx:"50%",cy:"50%",innerRadius:$,outerRadius:B,paddingAngle:2,stroke:_.cardBg,strokeWidth:2,label:x===void 0?S:void 0,labelLine:b,activeIndex:x,activeShape:P,onMouseEnter:o,onMouseLeave:k,onClick:(R,N)=>w(R,N),cursor:j?"pointer":void 0,isAnimationActive:u,animationDuration:600,animationEasing:"ease-out",children:y.map((R,N)=>e.jsx(ye,{fill:_.getColor(N)},N))}),e.jsx(ee,{content:e.jsx(se,{formatType:d,valueFormatter:c})}),n&&e.jsx(te,{layout:"vertical",verticalAlign:"middle",align:"right",wrapperStyle:{fontSize:12,paddingLeft:16},formatter:(R,N)=>{const T=y.findIndex(H=>H[s]===R),F=T>=0?Number(y[T][C]):0,W=p>0?(F/p*100).toFixed(1):"0";return`${R} (${W}%)`}})]})})})}function Q({config:t,loading:a=!1,error:s=null,allowedTypes:r=["line","bar","area"],onExport:n,onRetry:l,fullWidth:d=!1,height:c=300,formatType:m="default",valueFormatter:g,labelFormatter:u,onDataClick:b}){const[h,j]=i.useState(t.type),[f,_]=i.useState(!1),x=["chart-widget",d?"chart-card--full-width":"chart-card--half-width"].filter(Boolean).join(" "),v=i.useCallback(C=>{n?.(C),_(!1)},[n]);return e.jsxs("div",{className:x,children:[e.jsxs("div",{className:"chart-widget__header",children:[e.jsxs("div",{className:"chart-widget__title-group",children:[e.jsx("h3",{className:"chart-widget__title",children:t.title}),t.subtitle&&e.jsx("p",{className:"chart-widget__subtitle",children:t.subtitle})]}),e.jsxs("div",{className:"chart-widget__actions",children:[r.length>1&&e.jsx("div",{className:"chart-widget__type-switcher",role:"radiogroup","aria-label":"Chart type",children:r.map(C=>e.jsx("button",{className:`chart-widget__type-btn ${h===C?"chart-widget__type-btn--active":""}`,onClick:()=>j(C),role:"radio","aria-checked":h===C,title:`${C} chart`,children:Ot(C)},C))}),n&&e.jsxs("div",{className:"chart-widget__export-wrapper",children:[e.jsx("button",{className:"chart-widget__action-btn",onClick:()=>_(!f),"aria-haspopup":"menu","aria-expanded":f,title:"Export chart",children:e.jsx(Bt,{})}),f&&e.jsxs("div",{className:"chart-widget__export-menu",role:"menu",children:[e.jsx("button",{role:"menuitem",onClick:()=>v("pdf"),children:"Export as PDF"}),e.jsx("button",{role:"menuitem",onClick:()=>v("csv"),children:"Export as CSV"}),e.jsx("button",{role:"menuitem",onClick:()=>v("image"),children:"Export as Image"})]})]})]})]}),e.jsxs("div",{className:"chart-widget__body",style:{height:`${c}px`},"aria-label":`${t.title} chart`,children:[a&&e.jsx(Ft,{height:c}),s&&e.jsxs("div",{className:"chart-widget__error",role:"alert",children:[e.jsx("span",{className:"chart-widget__error-icon","aria-hidden":"true",children:"!"}),e.jsx("p",{className:"chart-widget__error-message",children:"Failed to load chart data"}),e.jsx("p",{className:"chart-widget__error-detail",children:s}),l&&e.jsx("button",{className:"chart-widget__retry-btn",onClick:l,children:"Retry"})]}),!a&&!s&&e.jsx(It,{type:h,config:t,height:c,formatType:m,valueFormatter:g||t.valueFormatter,labelFormatter:u,onDataClick:b})]})]})}function It({type:t,config:a,height:s,formatType:r,valueFormatter:n,labelFormatter:l,onDataClick:d}){if(!a.data||a.data.length===0)return e.jsx("div",{className:"chart-widget__empty",children:e.jsx("p",{children:"No data available for the selected period."})});const c={data:a.data,series:a.series,height:s,showGrid:a.showGrid!==!1,showLegend:a.showLegend!==!1,formatType:r,valueFormatter:n,labelFormatter:l,title:a.title,description:a.subtitle,animate:!0};switch(t){case"line":return e.jsx(xe,{...c,xAxisKey:a.xAxisKey,onDataPointClick:d,usePatterns:a.series.length>1});case"area":return e.jsx(At,{...c,xAxisKey:a.xAxisKey,onDataPointClick:d});case"bar":return e.jsx(Lt,{...c,xAxisKey:a.xAxisKey,onBarClick:d?(m,g)=>d(m,g):void 0});case"pie":case"donut":return e.jsx(Pt,{...c,labelKey:a.xAxisKey,donut:t==="donut",onSliceClick:d});default:return e.jsx(xe,{...c,xAxisKey:a.xAxisKey,onDataPointClick:d})}}function Ft({height:t}){return e.jsx("div",{className:"chart-widget__skeleton",style:{height:`${t}px`},"aria-busy":"true","aria-label":"Loading chart",children:e.jsx("div",{className:"skeleton skeleton--rect",style:{width:"100%",height:"100%"}})})}function Ot(t){switch(t){case"line":return"╱";case"area":return"△";case"bar":return"┃";case"pie":case"donut":return"○";default:return"╱"}}function Bt(){return e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none","aria-hidden":"true",children:e.jsx("path",{d:"M8 1v9M4 6l4-4 4 4M2 11v2a2 2 0 002 2h8a2 2 0 002-2v-2",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}const Wt=(t,a,s)=>{const r=String(s).toLowerCase();return r?t.getAllCells().map(l=>{const d=l.getValue();return d!=null?String(d).toLowerCase():""}).some(l=>l.includes(r)):!0};function zt(t){const{data:a,columns:s,enableSorting:r=!0,enableMultiSort:n=!0,enableColumnFilters:l=!0,enableGlobalFilter:d=!0,enableRowSelection:c=!1,enablePagination:m=!0,initialPageSize:g=10,pageSizeOptions:u=[10,25,50,100],getRowId:b}=t,[h,j]=i.useState([]),[f,_]=i.useState([]),[x,v]=i.useState(""),[C,y]=i.useState({}),[p,w]=i.useState({pageIndex:0,pageSize:g}),o=Qe({data:a,columns:s,state:{sorting:h,columnFilters:f,globalFilter:x,rowSelection:C,pagination:p},onSortingChange:j,onColumnFiltersChange:_,onGlobalFilterChange:v,onRowSelectionChange:y,onPaginationChange:w,getCoreRowModel:et(),getSortedRowModel:r?Ze():void 0,getFilteredRowModel:l||d?Xe():void 0,getPaginationRowModel:m?Je():void 0,enableSorting:r,enableMultiSort:n,enableColumnFilters:l,enableGlobalFilter:d,enableRowSelection:c,globalFilterFn:Wt,getRowId:b?$=>b($):void 0}),k=i.useMemo(()=>c?o.getSelectedRowModel().rows.map($=>$.original):[],[o,C,c]),S=o.getFilteredRowModel().rows.length,P=a.length,z=x!==""||f.length>0,E=i.useCallback(()=>{y({})},[]),O=i.useCallback(()=>{v(""),_([]),w($=>({...$,pageIndex:0}))},[]);return{table:o,globalFilter:x,setGlobalFilter:v,sorting:h,columnFilters:f,rowSelection:C,pagination:p,pageSizeOptions:u,selectedRows:k,filteredRowCount:S,totalRowCount:P,clearSelection:E,clearAllFilters:O,hasActiveFilters:z}}function Kt(t,a){return typeof a=="function"?a(t):t[a]}function be(t){if(t==null)return"";const a=String(t);return a.includes(",")||a.includes('"')||a.includes(`
`)||a.includes("\r")?`"${a.replace(/"/g,'""')}"`:a}function Ht(t){const{columns:a,data:s}=t,r=a.map(l=>be(l.header)).join(","),n=s.map(l=>a.map(d=>be(Kt(l,d.accessor))).join(","));return[r,...n].join(`\r
`)}function Gt(t){const{filename:a="export",includeTimestamp:s=!0,includeBOM:r=!0}=t,n=Ht(t),l=s?`_${new Date().toISOString().slice(0,19).replace(/[T:]/g,"-")}`:"",d=`${a}${l}.csv`,c=r?"\uFEFF":"",m=new Blob([c+n],{type:"text/csv;charset=utf-8;"}),g=URL.createObjectURL(m),u=document.createElement("a");u.href=g,u.download=d,u.style.display="none",document.body.appendChild(u),u.click(),setTimeout(()=>{document.body.removeChild(u),URL.revokeObjectURL(g)},100)}function Vt(t){const{count:a,estimateSize:s,overscan:r=10,containerHeight:n,enabled:l}=t,d=i.useRef(null),[c,m]=i.useState(0),g=a*s,u=i.useCallback(()=>{d.current&&m(d.current.scrollTop)},[]);return i.useEffect(()=>{const h=d.current;if(!(!h||!l))return h.addEventListener("scroll",u,{passive:!0}),()=>h.removeEventListener("scroll",u)},[u,l]),{virtualRows:i.useMemo(()=>{if(!l||a===0)return[];const h=Math.max(0,Math.floor(c/s)-r),j=Math.ceil(n/s),f=Math.min(a-1,h+j+r*2),_=[];for(let x=h;x<=f;x++)_.push({index:x,start:x*s,end:(x+1)*s,size:s});return _},[a,s,r,n,c,l]),totalHeight:g,containerRef:d,rowHeight:s}}function Ut({title:t,subtitle:a,data:s,columns:r,enableSorting:n=!0,enableMultiSort:l=!0,enableColumnFilters:d=!0,enableGlobalFilter:c=!0,enableRowSelection:m=!1,enableExport:g=!0,enablePagination:u=!0,enableVirtualScrolling:b=!1,virtualScrollHeight:h=500,initialPageSize:j=10,pageSizeOptions:f=[10,25,50,100],getRowId:_,onRowClick:x,onBatchAction:v,batchActions:C=[],loading:y=!1,error:p=null,onRetry:w,className:o="",exportFilename:k="table-export",mobileHiddenColumns:S=[],striped:P=!1,compact:z=!1,emptyMessage:E="No data found"}){const O=i.useRef(null),$=i.useMemo(()=>m?[{id:"_select",header:({table:I})=>e.jsx("input",{type:"checkbox",className:"dt-checkbox",checked:I.getIsAllPageRowsSelected(),ref:L=>{L&&(L.indeterminate=I.getIsSomePageRowsSelected())},onChange:I.getToggleAllPageRowsSelectedHandler(),"aria-label":"Select all rows on this page"}),cell:({row:I})=>e.jsx("input",{type:"checkbox",className:"dt-checkbox",checked:I.getIsSelected(),disabled:!I.getCanSelect(),onChange:I.getToggleSelectedHandler(),onClick:L=>L.stopPropagation(),"aria-label":`Select row ${I.id}`}),size:44,enableSorting:!1,enableColumnFilter:!1},...r]:r,[r,m]),{table:B,globalFilter:R,setGlobalFilter:N,selectedRows:T,filteredRowCount:F,totalRowCount:W,clearSelection:H,clearAllFilters:D,hasActiveFilters:M,pageSizeOptions:V}=zt({data:s,columns:$,enableSorting:n,enableMultiSort:l,enableColumnFilters:d,enableGlobalFilter:c,enableRowSelection:m,enablePagination:u&&!b,initialPageSize:j,pageSizeOptions:f,getRowId:_}),G=B.getRowModel().rows,{virtualRows:U,totalHeight:q,containerRef:ne,rowHeight:Le}=Vt({count:b?G.length:0,estimateSize:z?36:44,overscan:10,containerHeight:h,enabled:b}),Pe=i.useCallback(()=>{const A=r.filter(L=>L.id!=="_select").map(L=>({id:String(L.id??""),header:typeof L.header=="string"?L.header:String(L.id??""),accessor:L.accessorKey?L.accessorKey:L.accessorFn?L.accessorFn:ie=>ie[L.accessorKey??L.id??""]})),I=T.length>0?T:B.getFilteredRowModel().rows.map(L=>L.original);Gt({columns:A,data:I,filename:k,includeTimestamp:!0})},[r,T,B,k]),Ie=i.useCallback(A=>{v&&T.length>0&&v(A,T)},[v,T]);if(y)return e.jsxs("div",{className:`dt ${z?"dt--compact":""} dt--loading ${o}`,"aria-busy":"true","aria-label":"Loading table data",children:[t&&e.jsx("div",{className:"dt__header",children:e.jsx("h3",{className:"dt__title",children:t})}),e.jsx("div",{className:"dt__skeleton",children:Array.from({length:6},(A,I)=>e.jsx("div",{className:"dt__skeleton-row",children:Array.from({length:Math.min(r.length,5)},(L,ie)=>e.jsx("div",{className:"dt__skeleton-cell"},ie))},I))})]});if(p)return e.jsxs("div",{className:`dt dt--error ${o}`,children:[t&&e.jsx("div",{className:"dt__header",children:e.jsx("h3",{className:"dt__title",children:t})}),e.jsxs("div",{className:"dt__error",role:"alert",children:[e.jsx("p",{className:"dt__error-title",children:"Failed to load data"}),e.jsx("p",{className:"dt__error-detail",children:p}),w&&e.jsx("button",{className:"dt__error-retry",onClick:w,children:"Retry"})]})]});const Fe=B.getHeaderGroups(),me=b?G:B.getRowModel().rows;return e.jsxs("div",{className:`dt ${z?"dt--compact":""} ${P?"dt--striped":""} ${o}`,role:"region","aria-label":t||"Data table",children:[e.jsxs("div",{className:"dt__toolbar",children:[e.jsx("div",{className:"dt__toolbar-left",children:t&&e.jsxs("div",{className:"dt__title-group",children:[e.jsx("h3",{className:"dt__title",children:t}),a&&e.jsx("p",{className:"dt__subtitle",children:a})]})}),e.jsxs("div",{className:"dt__toolbar-right",children:[c&&e.jsxs("div",{className:"dt__search",children:[e.jsx("input",{type:"search",className:"dt__search-input",placeholder:"Search all columns...",value:R,onChange:A=>N(A.target.value),"aria-label":"Search table"}),R&&e.jsx("button",{className:"dt__search-clear",onClick:()=>N(""),"aria-label":"Clear search",children:"×"})]}),M&&e.jsx("button",{className:"dt__btn dt__btn--ghost",onClick:D,children:"Clear filters"}),g&&e.jsxs("button",{className:"dt__btn dt__btn--secondary",onClick:Pe,children:[e.jsx("span",{className:"dt__btn-icon","aria-hidden":"true",children:"↧"}),"Export CSV",T.length>0&&` (${T.length})`]})]})]}),m&&T.length>0&&e.jsxs("div",{className:"dt__batch-bar",role:"toolbar","aria-label":"Batch actions",children:[e.jsxs("span",{className:"dt__batch-count",children:[T.length," row",T.length!==1?"s":""," selected"]}),e.jsxs("div",{className:"dt__batch-actions",children:[C.map(A=>e.jsx("button",{className:`dt__btn ${A.variant==="danger"?"dt__btn--danger":"dt__btn--secondary"}`,onClick:()=>Ie(A.id),children:A.label},A.id)),e.jsx("button",{className:"dt__btn dt__btn--ghost",onClick:H,children:"Clear selection"})]})]}),e.jsx("div",{className:"dt__scroll-container",ref:b?ne:O,style:b?{height:h,overflow:"auto"}:void 0,tabIndex:0,children:e.jsxs("table",{className:"dt__table",role:"grid","aria-rowcount":F,"aria-colcount":$.length,children:[e.jsx("thead",{className:"dt__thead",children:Fe.map(A=>e.jsx("tr",{role:"row",children:A.headers.map(I=>e.jsx(Yt,{header:I,mobileHiddenColumns:S,enableColumnFilters:d},I.id))},A.id))}),e.jsx("tbody",{className:"dt__tbody",children:b?e.jsxs(e.Fragment,{children:[q>0&&e.jsx("tr",{style:{height:U[0]?.start??0},children:e.jsx("td",{colSpan:$.length,style:{padding:0,border:"none"}})}),U.map(A=>{const I=G[A.index];return I?e.jsx(_e,{row:I,onRowClick:x,mobileHiddenColumns:S,style:{height:Le}},I.id):null}),q>0&&e.jsx("tr",{style:{height:Math.max(0,q-(U[U.length-1]?.end??0))},children:e.jsx("td",{colSpan:$.length,style:{padding:0,border:"none"}})})]}):me.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:$.length,className:"dt__empty-cell",children:E})}):me.map(A=>e.jsx(_e,{row:A,onRowClick:x,mobileHiddenColumns:S},A.id))})]})}),u&&!b&&e.jsx(qt,{table:B,pageSizeOptions:V,filteredRowCount:F,totalRowCount:W}),b&&e.jsx("div",{className:"dt__virtual-info",children:e.jsxs("span",{className:"dt__page-info",children:["Showing ",G.length.toLocaleString()," of"," ",W.toLocaleString()," rows",M?" (filtered)":""]})})]})}function Yt({header:t,mobileHiddenColumns:a,enableColumnFilters:s}){const r=t.column.getCanSort(),n=t.column.getIsSorted(),l=a.includes(t.column.id);return e.jsxs("th",{className:`dt__th ${r?"dt__th--sortable":""} ${l?"dt__th--mobile-hidden":""} ${t.column.id==="_select"?"dt__th--checkbox":""}`,style:{width:t.getSize()!==150?t.getSize():void 0},onClick:r?t.column.getToggleSortingHandler():void 0,"aria-sort":n==="asc"?"ascending":n==="desc"?"descending":"none",role:"columnheader",tabIndex:r?0:void 0,onKeyDown:r?d=>{(d.key==="Enter"||d.key===" ")&&(d.preventDefault(),t.column.toggleSorting(void 0,d.shiftKey))}:void 0,children:[e.jsxs("div",{className:"dt__th-content",children:[t.isPlaceholder?null:ke(t.column.columnDef.header,t.getContext()),r&&e.jsx("span",{className:"dt__sort-indicator","aria-hidden":"true",children:n==="asc"?e.jsx("span",{className:"dt__sort-icon dt__sort-icon--active",children:"▲"}):n==="desc"?e.jsx("span",{className:"dt__sort-icon dt__sort-icon--active",children:"▼"}):e.jsx("span",{className:"dt__sort-icon",children:"▲▼"})})]}),s&&t.column.getCanFilter()&&t.column.id!=="_select"&&e.jsx("div",{className:"dt__column-filter",onClick:d=>d.stopPropagation(),children:e.jsx("input",{type:"text",className:"dt__filter-input",placeholder:"Filter...",value:t.column.getFilterValue()??"",onChange:d=>t.column.setFilterValue(d.target.value||void 0),"aria-label":`Filter ${typeof t.column.columnDef.header=="string"?t.column.columnDef.header:t.column.id}`})})]})}function _e({row:t,onRowClick:a,mobileHiddenColumns:s,style:r}){return e.jsx("tr",{className:`dt__tr ${t.getIsSelected()?"dt__tr--selected":""} ${a?"dt__tr--clickable":""}`,onClick:a?()=>a(t.original):void 0,style:r,role:"row","aria-selected":t.getIsSelected()||void 0,tabIndex:a?0:void 0,onKeyDown:a?n=>{n.key==="Enter"&&a(t.original)}:void 0,children:t.getVisibleCells().map(n=>{const l=s.includes(n.column.id);return e.jsx("td",{className:`dt__td ${l?"dt__td--mobile-hidden":""} ${n.column.id==="_select"?"dt__td--checkbox":""}`,role:"gridcell",children:ke(n.column.columnDef.cell,n.getContext())},n.id)})})}function qt({table:t,pageSizeOptions:a,filteredRowCount:s,totalRowCount:r}){const n=t.getState().pagination.pageIndex,l=t.getState().pagination.pageSize,d=t.getPageCount(),c=n*l+1,m=Math.min((n+1)*l,s),g=()=>{if(d<=7)return Array.from({length:d},(b,h)=>h);const u=[0];n>2&&u.push("ellipsis");for(let b=Math.max(1,n-1);b<=Math.min(d-2,n+1);b++)u.push(b);return n<d-3&&u.push("ellipsis"),u.push(d-1),u};return e.jsxs("div",{className:"dt__pagination",role:"navigation","aria-label":"Table pagination",children:[e.jsx("div",{className:"dt__pagination-info",children:e.jsxs("span",{className:"dt__page-info",children:[s>0?`${c}--${m} of ${s.toLocaleString()}`:"0 results",s!==r&&e.jsxs("span",{className:"dt__page-info-filtered",children:[" ","(filtered from ",r.toLocaleString(),")"]})]})}),e.jsxs("div",{className:"dt__pagination-pages",children:[e.jsx("button",{className:"dt__page-btn",onClick:()=>t.setPageIndex(0),disabled:!t.getCanPreviousPage(),"aria-label":"First page",children:"«"}),e.jsx("button",{className:"dt__page-btn",onClick:()=>t.previousPage(),disabled:!t.getCanPreviousPage(),"aria-label":"Previous page",children:"‹"}),g().map((u,b)=>u==="ellipsis"?e.jsx("span",{className:"dt__page-ellipsis",children:"…"},`ellipsis-${b}`):e.jsx("button",{className:`dt__page-btn ${u===n?"dt__page-btn--active":""}`,onClick:()=>t.setPageIndex(u),"aria-label":`Page ${u+1}`,"aria-current":u===n?"page":void 0,children:u+1},u)),e.jsx("button",{className:"dt__page-btn",onClick:()=>t.nextPage(),disabled:!t.getCanNextPage(),"aria-label":"Next page",children:"›"}),e.jsx("button",{className:"dt__page-btn",onClick:()=>t.setPageIndex(d-1),disabled:!t.getCanNextPage(),"aria-label":"Last page",children:"»"})]}),e.jsxs("div",{className:"dt__pagination-size",children:[e.jsx("label",{htmlFor:"dt-page-size",className:"dt__page-size-label",children:"Rows per page:"}),e.jsx("select",{id:"dt-page-size",className:"dt__page-size-select",value:l,onChange:u=>t.setPageSize(Number(u.target.value)),children:a.map(u=>e.jsx("option",{value:u,children:u},u))})]})]})}const K=tt();function Qt({status:t}){const s={completed:"success",pending:"warning",refunded:"danger",cancelled:"danger"}[t]||"default";return e.jsx("span",{className:`badge badge--${s}`,children:t.charAt(0).toUpperCase()+t.slice(1)})}const Jt=[K.accessor("id",{header:"Transaction ID",cell:t=>e.jsx("span",{className:"dt__cell-mono",children:t.getValue()}),size:140,enableColumnFilter:!0}),K.accessor("date",{header:"Date",cell:t=>yt(t.getValue(),"medium"),sortingFn:"datetime",enableColumnFilter:!0,size:130}),K.accessor("customer",{header:"Customer",enableColumnFilter:!0,size:160}),K.accessor("product",{header:"Product",enableColumnFilter:!0,size:160}),K.accessor("category",{header:"Category",enableColumnFilter:!0,size:130}),K.accessor("amount",{header:"Amount",cell:t=>e.jsx("span",{className:"dt__cell-currency",children:ue(t.getValue())}),enableColumnFilter:!1,size:120,meta:{align:"right"}}),K.accessor("quantity",{header:"Qty",enableColumnFilter:!1,size:70,meta:{align:"right"}}),K.accessor("status",{header:"Status",cell:t=>e.jsx(Qt,{status:t.getValue()}),enableColumnFilter:!0,size:110}),K.accessor("region",{header:"Region",enableColumnFilter:!0,size:140}),K.accessor("salesRep",{header:"Sales Rep",enableColumnFilter:!0,size:140})],Xt=["category","quantity","region","salesRep"],Zt=[{label:"Today",value:"today"},{label:"7 Days",value:"7d"},{label:"30 Days",value:"30d"},{label:"90 Days",value:"90d"},{label:"Quarter",value:"quarter"},{label:"Year",value:"year"},{label:"Custom",value:"custom"}],ea=[{label:"Electronics",value:"electronics"},{label:"Clothing",value:"clothing"},{label:"Home & Garden",value:"home"},{label:"Sports",value:"sports"},{label:"Books",value:"books"}],ta=[{id:"last-week",name:"Last Week",filters:{dateRange:{start:new Date(Date.now()-7*864e5),end:new Date,preset:"7d"}}},{id:"this-month",name:"This Month",filters:{dateRange:{start:new Date(Date.now()-30*864e5),end:new Date,preset:"30d"}},isDefault:!0},{id:"this-quarter",name:"This Quarter",filters:{dateRange:{start:new Date(Date.now()-90*864e5),end:new Date,preset:"90d"}}}];function aa({categories:t=ea,presets:a=ta,onApply:s}){const{filters:r,setDatePreset:n,setDateRange:l,setCategories:d,toggleCategory:c,setSearch:m,resetFilters:g,activeFilterCount:u,triggerRefresh:b}=Re(),[h,j]=i.useState(r.dateRange.preset==="custom"),[f,_]=i.useState(!1),[x,v]=i.useState(!1),C=i.useCallback(o=>{o==="custom"?j(!0):(j(!1),n(o))},[n]),y=i.useCallback((o,k)=>{const S=new Date(k);isNaN(S.getTime())||l({...r.dateRange,[o]:S,preset:"custom"})},[r.dateRange,l]),p=i.useCallback(o=>{o.filters.dateRange&&l(o.filters.dateRange),o.filters.categories&&d(o.filters.categories),v(!1)},[l,d]),w=i.useCallback(()=>{b(),s?.()},[b,s]);return e.jsxs("div",{className:"filter-panel",role:"search","aria-label":"Dashboard filters",children:[e.jsxs("div",{className:"filter-panel__group",children:[e.jsx("label",{className:"filter-panel__label",htmlFor:"filter-search",children:"Search"}),e.jsxs("div",{className:"filter-panel__search-wrapper",children:[e.jsx(sa,{}),e.jsx("input",{id:"filter-search",type:"search",className:"filter-panel__search-input",placeholder:"Search transactions...",value:r.search,onChange:o=>m(o.target.value)})]})]}),e.jsxs("div",{className:"filter-panel__group",children:[e.jsx("label",{className:"filter-panel__label",children:"Date Range"}),e.jsx("div",{className:"filter-panel__date-presets",role:"radiogroup","aria-label":"Date range presets",children:Zt.map(o=>e.jsx("button",{className:`filter-panel__preset-btn ${r.dateRange.preset===o.value?"filter-panel__preset-btn--active":""}`,onClick:()=>C(o.value),role:"radio","aria-checked":r.dateRange.preset===o.value,children:o.label},o.value))}),h&&e.jsxs("div",{className:"filter-panel__custom-dates",children:[e.jsx("input",{type:"date",className:"filter-panel__date-input",value:ve(r.dateRange.start),onChange:o=>y("start",o.target.value),"aria-label":"Start date"}),e.jsx("span",{className:"filter-panel__date-separator",children:"to"}),e.jsx("input",{type:"date",className:"filter-panel__date-input",value:ve(r.dateRange.end),onChange:o=>y("end",o.target.value),"aria-label":"End date"})]})]}),e.jsxs("div",{className:"filter-panel__group",children:[e.jsx("label",{className:"filter-panel__label",children:"Category"}),e.jsxs("div",{className:"filter-panel__multiselect",children:[e.jsxs("button",{className:"filter-panel__multiselect-trigger",onClick:()=>_(!f),"aria-haspopup":"listbox","aria-expanded":f,children:[r.categories.length===0?"All Categories":`${r.categories.length} selected`,e.jsx("span",{className:"filter-panel__chevron","aria-hidden":"true",children:f?"▲":"▼"})]}),f&&e.jsx("div",{className:"filter-panel__dropdown",role:"listbox","aria-multiselectable":"true",children:t.map(o=>e.jsxs("label",{className:"filter-panel__dropdown-item",role:"option","aria-selected":r.categories.includes(o.value),children:[e.jsx("input",{type:"checkbox",checked:r.categories.includes(o.value),onChange:()=>c(o.value)}),e.jsx("span",{children:o.label})]},o.value))})]}),r.categories.length>0&&e.jsx("div",{className:"filter-panel__chips",children:r.categories.map(o=>{const k=t.find(S=>S.value===o);return e.jsxs("span",{className:"filter-panel__chip",children:[k?.label??o,e.jsx("button",{className:"filter-panel__chip-remove",onClick:()=>c(o),"aria-label":`Remove ${k?.label??o} filter`,children:"×"})]},o)})})]}),e.jsxs("div",{className:"filter-panel__group filter-panel__group--presets",children:[e.jsxs("button",{className:"filter-panel__presets-btn",onClick:()=>v(!x),"aria-haspopup":"menu","aria-expanded":x,children:["FilterPresets (",a.length,")"]}),x&&e.jsx("div",{className:"filter-panel__presets-menu",role:"menu",children:a.map(o=>e.jsxs("button",{role:"menuitem",className:"filter-panel__preset-item",onClick:()=>p(o),children:[o.name,o.isDefault&&e.jsx("span",{className:"filter-panel__default-badge",children:"Default"})]},o.id))})]}),e.jsxs("div",{className:"filter-panel__actions",children:[e.jsx("button",{className:"filter-panel__apply-btn",onClick:w,children:"Apply Filters"}),e.jsxs("button",{className:"filter-panel__reset-btn",onClick:g,disabled:u===0,children:["Reset",u>0?` (${u})`:""]})]})]})}function ve(t){return t.toISOString().split("T")[0]}function sa(){return e.jsx("svg",{className:"filter-panel__search-icon",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none","aria-hidden":"true",children:e.jsx("path",{d:"M7 12A5 5 0 107 2a5 5 0 000 10zM14 14l-3.5-3.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}const Ae=[{id:"kpi-revenue",type:"kpi",title:"Revenue",description:"Total revenue with trend and sparkline",defaultW:3,defaultH:2,icon:"$"},{id:"kpi-orders",type:"kpi",title:"Orders",description:"Total order count with trend",defaultW:3,defaultH:2,icon:"#"},{id:"kpi-conversion",type:"kpi",title:"Conversion Rate",description:"Conversion rate with trend indicator",defaultW:3,defaultH:2,icon:"%"},{id:"kpi-aov",type:"kpi",title:"Average Order Value",description:"AOV with sparkline and comparison",defaultW:3,defaultH:2,icon:"ø"},{id:"chart-revenue-trend",type:"chart",title:"Revenue Trend",description:"Line/area chart of daily revenue over time",defaultW:8,defaultH:4,icon:"╱"},{id:"chart-comparison",type:"chart",title:"Product Comparison",description:"Bar chart comparing product performance",defaultW:6,defaultH:4,icon:"┃"},{id:"chart-category",type:"chart",title:"Category Breakdown",description:"Pie/donut chart of sales by category",defaultW:4,defaultH:4,icon:"○"},{id:"chart-distribution",type:"chart",title:"Regional Distribution",description:"Pie chart of sales distribution by region",defaultW:6,defaultH:4,icon:"○"},{id:"table-transactions",type:"table",title:"Transactions Table",description:"Sortable, filterable data table of recent transactions",defaultW:12,defaultH:5,icon:"≡"}];function ra({activeWidgetIds:t,onAddWidget:a,onRemoveWidget:s,isOpen:r=!0,onClose:n}){const[l,d]=i.useState("all"),[c,m]=i.useState(""),g=Ae.filter(h=>{if(l!=="all"&&h.type!==l)return!1;if(c){const j=c.toLowerCase();return h.title.toLowerCase().includes(j)||h.description.toLowerCase().includes(j)}return!0}),u=i.useCallback(h=>{a(h)},[a]),b=i.useCallback(h=>{s(h)},[s]);return r?e.jsxs("aside",{className:"widget-catalog",role:"complementary","aria-label":"Widget catalog",children:[e.jsxs("div",{className:"widget-catalog__header",children:[e.jsx("h3",{className:"widget-catalog__title",children:"Widget Catalog"}),n&&e.jsx("button",{className:"widget-catalog__close-btn",onClick:n,"aria-label":"Close widget catalog",children:"×"})]}),e.jsx("div",{className:"widget-catalog__search",children:e.jsx("input",{type:"search",placeholder:"Search widgets...",value:c,onChange:h=>m(h.target.value),className:"widget-catalog__search-input","aria-label":"Search widgets"})}),e.jsx("div",{className:"widget-catalog__type-filter",role:"tablist","aria-label":"Filter by type",children:["all","kpi","chart","table"].map(h=>e.jsx("button",{className:`widget-catalog__type-btn ${l===h?"widget-catalog__type-btn--active":""}`,onClick:()=>d(h),role:"tab","aria-selected":l===h,children:h==="all"?"All":h.charAt(0).toUpperCase()+h.slice(1)},h))}),e.jsx("ul",{className:"widget-catalog__list",role:"list",children:g.map(h=>{const j=t.includes(h.id);return e.jsxs("li",{className:"widget-catalog__item",children:[e.jsx("div",{className:"widget-catalog__item-icon","aria-hidden":"true",children:h.icon}),e.jsxs("div",{className:"widget-catalog__item-info",children:[e.jsx("span",{className:"widget-catalog__item-title",children:h.title}),e.jsx("span",{className:"widget-catalog__item-description",children:h.description})]}),e.jsx("button",{className:`widget-catalog__item-action ${j?"widget-catalog__item-action--remove":""}`,onClick:()=>j?b(h.id):u(h),"aria-label":j?`Remove ${h.title}`:`Add ${h.title}`,children:j?"−":"+"})]},h.id)})}),g.length===0&&e.jsx("p",{className:"widget-catalog__empty",children:"No widgets match your search."})]}):null}function na(t,a={}){const{interval:s=3e4,enabled:r=!0,pauseOnHidden:n=!0,maxBackoff:l=6e4,immediate:d=!0}=a,[c,m]=i.useState(null),[g,u]=i.useState(null),[b,h]=i.useState(r),[j,f]=i.useState(null),_=i.useRef(0),x=i.useRef(null),v=i.useRef(t);v.current=t;const C=i.useCallback(async()=>{try{const o=await v.current();m(o),u(null),f(Date.now()),_.current=0}catch(o){u(o instanceof Error?o:new Error(String(o))),_.current++}},[]);i.useEffect(()=>{if(!b){x.current&&(clearInterval(x.current),x.current=null);return}d&&C();const o=Math.min(s*Math.pow(2,_.current),l);return x.current=setInterval(C,o),()=>{x.current&&(clearInterval(x.current),x.current=null)}},[b,s,l,d,C]),i.useEffect(()=>{if(!n)return;const o=()=>{document.hidden?x.current&&(clearInterval(x.current),x.current=null):b&&(C(),x.current=setInterval(C,s))};return document.addEventListener("visibilitychange",o),()=>{document.removeEventListener("visibilitychange",o)}},[n,b,s,C]);const y=i.useCallback(()=>h(!0),[]),p=i.useCallback(()=>h(!1),[]),w=i.useCallback(()=>{C()},[C]);return{data:c,error:g,isPolling:b,lastFetched:j,start:y,pause:p,refetch:w}}function ia(t,a={format:"csv"}){if(!t||t.length===0){console.warn("exportToCSV: No data to export");return}const s=a.filename||`dashboard-export-${ge()}`,r=Object.keys(t[0]),n=[];n.push(r.map(je).join(","));for(const d of t){const c=r.map(m=>je(String(d[m]??"")));n.push(c.join(","))}const l=n.join(`
`);da(l,`${s}.csv`,"text/csv;charset=utf-8;")}function je(t){return t.includes(",")||t.includes('"')||t.includes(`
`)?`"${t.replace(/"/g,'""')}"`:t}async function la(t,a={format:"image"}){if(!t){console.warn("exportToImage: No element provided");return}const s=a.filename||`dashboard-export-${ge()}`;try{const r=window.html2canvas;if(typeof r=="function"){const h=(await r(t,{backgroundColor:"#ffffff",scale:2,useCORS:!0})).toDataURL("image/png");oe(h,`${s}.png`);return}const{width:n,height:l}=t.getBoundingClientRect(),d=new XMLSerializer,c=t.cloneNode(!0),m=`
      <svg xmlns="http://www.w3.org/2000/svg" width="${n}" height="${l}">
        <foreignObject width="100%" height="100%">
          ${d.serializeToString(c)}
        </foreignObject>
      </svg>
    `,g=new Blob([m],{type:"image/svg+xml;charset=utf-8"}),u=URL.createObjectURL(g);oe(u,`${s}.svg`),URL.revokeObjectURL(u)}catch(r){console.error("exportToImage failed:",r)}}async function oa(t,a={format:"pdf"}){if(!t){console.warn("exportToPDF: No element provided");return}const s=a.filename||`dashboard-export-${ge()}`;try{const r=window.jspdf?.jsPDF;if(r){const l=new r("l","mm","a4"),{width:d,height:c}=t.getBoundingClientRect(),m=await ua(t);if(m){const g=l.internal.pageSize.getWidth(),u=c/d*g;a.includeTimestamp&&(l.setFontSize(8),l.text(`Generated: ${new Date().toLocaleString()}`,10,8)),l.addImage(m,"PNG",0,10,g,u),l.save(`${s}.pdf`);return}}const n=window.open("","_blank");n&&(n.document.write(`
        <!DOCTYPE html>
        <html>
        <head>
          <title>${s}</title>
          <style>
            body { margin: 0; padding: 20px; font-family: -apple-system, sans-serif; }
            @media print { body { padding: 0; } }
          </style>
        </head>
        <body>${t.outerHTML}</body>
        </html>
      `),n.document.close(),n.print())}catch(r){console.error("exportToPDF failed:",r)}}async function ca(t,a={}){const s={format:t,filename:a.filename,includeTimestamp:a.includeTimestamp};switch(t){case"csv":a.data&&ia(a.data,s);break;case"image":await la(a.element??null,s);break;case"pdf":await oa(a.element??null,s);break;default:console.warn(`Unsupported export format: ${t}`)}}function ge(){return new Date().toISOString().replace(/[:.]/g,"-").slice(0,19)}function da(t,a,s){const r=new Blob([t],{type:s}),n=URL.createObjectURL(r);oe(n,a),URL.revokeObjectURL(n)}function oe(t,a){const s=document.createElement("a");s.href=t,s.download=a,s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s)}async function ua(t){try{const a=window.html2canvas;if(typeof a=="function")return(await a(t,{backgroundColor:"#ffffff",scale:2})).toDataURL("image/png")}catch{}return null}function ha(){const t=Be(),[a,s]=i.useState({isExporting:!1,progress:0,format:null}),r=i.useRef(null),n=i.useCallback(async(f,_)=>{s({isExporting:!0,progress:0,format:f});let x=0;r.current=setInterval(()=>{x=Math.min(x+Math.random()*15,90),s(v=>({...v,progress:x}))},200);try{await _(),r.current&&clearInterval(r.current),s({isExporting:!0,progress:100,format:f}),setTimeout(()=>{s({isExporting:!1,progress:0,format:null})},500),t.success("Export complete",`Your ${f.toUpperCase()} file has been downloaded.`)}catch(v){r.current&&clearInterval(r.current),s({isExporting:!1,progress:0,format:null}),t.error("Export failed",v instanceof Error?v.message:"An unexpected error occurred.")}},[t]),l=i.useCallback(f=>{f(),t.success("Dashboard refreshed","All widgets have been updated with the latest data.")},[t]),d=i.useCallback(f=>{f>0?t.info("Filters applied",`${f} filter${f>1?"s":""} active. Showing filtered results.`):t.info("Filters cleared","Showing all data.")},[t]),c=i.useCallback((f,_)=>{t.success(`${f} complete`,`${_} item${_>1?"s":""} ${f.toLowerCase()}.`)},[t]),m=i.useCallback((f,_)=>{t.error(f,_)},[t]),g=i.useCallback(f=>{f?t.success("Connection restored","Auto-refresh has resumed."):t.warning("Connection lost","You are offline. Dashboard data may be stale.")},[t]),[u,b]=i.useState({isOpen:!1,title:"",description:"",variant:"danger",confirmLabel:"Confirm",onConfirm:()=>{}}),h=i.useCallback(f=>{b({isOpen:!0,title:f.title,description:f.description,variant:f.variant||"danger",confirmLabel:f.confirmLabel||"Confirm",onConfirm:f.onConfirm})},[]),j=i.useCallback(()=>{b(f=>({...f,isOpen:!1}))},[]);return{toast:t,exportProgress:a,handleExportWithFeedback:n,handleRefreshWithFeedback:l,handleFilterApplied:d,handleBulkAction:c,handleError:m,handleConnectionChange:g,confirmDialog:u,showConfirmation:h,closeConfirmation:j}}async function ga(t){await new Promise(c=>setTimeout(c,300));const a=ma(),s=pa(t),r=fa(),n=xa(),l=_a(t),d=ba();return{kpis:a,revenueHistory:s,productPerformance:r,categoryBreakdown:n,transactions:l,regionData:d}}function ma(){return[{id:"revenue",label:"Revenue",value:1245832,previousValue:1080500,trend:15.3,trendDirection:"up",status:"positive",format:"currency",icon:"$",comparisonLabel:"vs last month",sparkline:[100,120,115,140,155,145,160,180,175,190,210,205]},{id:"orders",label:"Orders",value:3421,previousValue:3148,trend:8.7,trendDirection:"up",status:"positive",format:"number",icon:"#",comparisonLabel:"vs last month",sparkline:[80,95,88,105,110,102,115,120,118,125,130,128]},{id:"conversion",label:"Conversion Rate",value:3.8,previousValue:3.3,trend:.5,trendDirection:"up",status:"positive",format:"percentage",icon:"%",comparisonLabel:"vs last month",target:5,sparkline:[2.8,3,3.1,3.4,3.2,3.5,3.6,3.4,3.7,3.8,3.9,3.8]},{id:"aov",label:"Average Order Value",value:364.27,previousValue:343.14,trend:6.2,trendDirection:"up",status:"positive",format:"currency",icon:"ø",comparisonLabel:"vs last month",sparkline:[320,335,340,330,345,350,348,355,360,358,365,364]}]}function pa(t){const a=[],s=Math.max(7,Math.ceil((t.dateRange.end.getTime()-t.dateRange.start.getTime())/864e5));for(let r=0;r<s;r++){const n=new Date(t.dateRange.start);n.setDate(n.getDate()+r);const l=35e3+Math.sin(r*.3)*8e3,d=(Math.random()-.5)*1e4;a.push({date:n.toISOString().split("T")[0],revenue:Math.round(l+d),target:4e4})}return a}function fa(){return[{product:"Premium Widget",revenue:234e3,units:1250},{product:"Standard Widget",revenue:189e3,units:2100},{product:"Basic Widget",revenue:145e3,units:3500},{product:"Deluxe Widget",revenue:98e3,units:450},{product:"Compact Widget",revenue:87e3,units:1800}]}function xa(){return[{category:"Electronics",sales:425e3},{category:"Clothing",sales:38e4},{category:"Home & Garden",sales:29e4},{category:"Sports",sales:150832},{category:"Books",sales:95e3}]}function ba(){return[{region:"North America",revenue:52e4},{region:"Europe",revenue:38e4},{region:"Asia Pacific",revenue:245e3},{region:"Latin America",revenue:100832}]}function _a(t){const a=["Premium Widget","Standard Widget","Basic Widget","Deluxe Widget","Compact Widget"],s=["Acme Corp","GlobalTech","MegaCorp","TechStart","Enterprise Inc","DataDriven Ltd","CloudFirst","InnovateCo"],r=["Electronics","Clothing","Home & Garden","Sports","Books"],n=["North America","Europe","Asia Pacific","Latin America"],l=["completed","pending","completed","completed","refunded"],d=["John Smith","Jane Doe","Mike Johnson","Sarah Williams","Tom Brown"],c=[],m=(t.dateRange.end.getTime()-t.dateRange.start.getTime())/864e5;for(let g=0;g<50;g++){const u=new Date(t.dateRange.start.getTime()+Math.random()*m*864e5),b=a[Math.floor(Math.random()*a.length)],h=r[Math.floor(Math.random()*r.length)];t.categories.length>0&&!t.categories.includes(h.toLowerCase().replace(/\s&\s/g,""))||c.push({id:`TRX-${(1e3+g).toString()}`,date:u.toISOString().split("T")[0],customer:s[Math.floor(Math.random()*s.length)],product:b,category:h,amount:Math.floor(Math.random()*5e3)+200,quantity:Math.floor(Math.random()*10)+1,status:l[Math.floor(Math.random()*l.length)],region:n[Math.floor(Math.random()*n.length)],salesRep:d[Math.floor(Math.random()*d.length)]})}return c.sort((g,u)=>new Date(u.date).getTime()-new Date(g.date).getTime())}function wa(){return e.jsx(jt,{defaultAutoRefresh:!0,defaultRefreshInterval:3e4,children:e.jsx(ja,{})})}const va=[{id:"overview",label:"Overview",href:"/",icon:"■"},{id:"revenue",label:"Revenue",href:"/revenue",icon:"$"},{id:"orders",label:"Orders",href:"/orders",icon:"#"},{id:"products",label:"Products",href:"/products",icon:"○"},{id:"customers",label:"Customers",href:"/customers",icon:"☺"},{id:"reports",label:"Reports",href:"/reports",icon:"≡",children:[{id:"daily",label:"Daily Report",href:"/reports/daily"},{id:"weekly",label:"Weekly Report",href:"/reports/weekly"},{id:"monthly",label:"Monthly Report",href:"/reports/monthly"}]},{id:"settings",label:"Settings",href:"/settings",icon:"⚙"}];function ja(){const{filters:t,autoRefresh:a,refreshInterval:s,triggerRefresh:r}=Re(),{toggleTheme:n,isDark:l}=xt(),{exportProgress:d,handleExportWithFeedback:c,handleRefreshWithFeedback:m,handleBulkAction:g,confirmDialog:u,showConfirmation:b,closeConfirmation:h}=ha(),j=i.useRef(null),[f,_]=i.useState("/"),[x,v]=i.useState(!1),[C,y]=i.useState(!1),[p,w]=i.useState(Ae.map(D=>D.id)),{data:o}=na(()=>ga(t),{interval:s,enabled:a,pauseOnHidden:!0,immediate:!0}),k=o?.kpis??[],S=o?.revenueHistory??[],P=o?.productPerformance??[],z=o?.categoryBreakdown??[],E=o?.transactions??[],O={id:"chart-revenue-trend",title:"Revenue Trend",subtitle:"Daily revenue over selected period",type:"line",data:S,series:[{name:"Revenue",dataKey:"revenue"},{name:"Target",dataKey:"target",color:"var(--chart-color-4)"}],xAxisKey:"date",showLegend:!0,showGrid:!0},$={id:"chart-comparison",title:"Product Comparison",subtitle:"Revenue by product",type:"bar",data:P,series:[{name:"Revenue",dataKey:"revenue"},{name:"Units",dataKey:"units"}],xAxisKey:"product",showLegend:!0},B={id:"chart-category",title:"Category Breakdown",subtitle:"Sales distribution by category",type:"pie",data:z,series:[{name:"Sales",dataKey:"sales"}],xAxisKey:"category",showLegend:!0},R={id:"chart-distribution",title:"Regional Distribution",subtitle:"Sales by region",type:"pie",data:o?.regionData??[],series:[{name:"Revenue",dataKey:"revenue"}],xAxisKey:"region",showLegend:!0},N=i.useCallback((D,M)=>{D==="delete"?b({title:"Delete selected transactions",description:`Are you sure you want to delete ${M.length} transaction${M.length>1?"s":""}? This action cannot be undone.`,variant:"danger",confirmLabel:"Delete",onConfirm:()=>{console.log(`Deleting ${M.length} rows`,M),g("Deleted",M.length)}}):(console.log(`Batch action "${D}" on ${M.length} rows`,M),g(D,M.length))},[b,g]),T=i.useCallback(async D=>{await c(D,async()=>{await ca(D,{element:j.current,data:E,filename:"sales-dashboard",includeTimestamp:!0})})},[E,c]),F=i.useCallback(D=>{p.includes(D.id)||w(M=>[...M,D.id])},[p]),W=i.useCallback(D=>{w(M=>M.filter(V=>V!==D))},[]),H=e.jsxs("div",{className:"layout-row layout-row--sm",children:[e.jsx("button",{className:"chart-widget__action-btn",onClick:n,title:l?"Switch to light mode":"Switch to dark mode","aria-label":"Toggle theme",children:l?"☀":"☽"}),e.jsx("button",{className:"chart-widget__action-btn",onClick:()=>v(!x),title:x?"Exit customization":"Customize dashboard","aria-label":"Toggle customization mode",children:x?"✓":"✎"}),e.jsx("button",{className:"chart-widget__action-btn",onClick:()=>y(!C),title:"Widget catalog","aria-label":"Open widget catalog",children:"+"}),e.jsx("button",{className:"filter-panel__apply-btn",onClick:()=>m(r),title:"Refresh data",children:"Refresh"})]});return e.jsxs(ct,{navItems:va,headerRight:H,title:"Sales Dashboard",activePath:f,onNavigate:_,children:[e.jsx("div",{ref:j,children:e.jsx(dt,{filterBar:e.jsx(aa,{}),kpiCards:e.jsx(e.Fragment,{children:k.map(D=>p.includes(`kpi-${D.id}`)?e.jsx(Rt,{data:D},D.id):null)}),charts:e.jsxs(e.Fragment,{children:[p.includes("chart-revenue-trend")&&e.jsx(Q,{config:O,onExport:T,fullWidth:!0,allowedTypes:["line","area"],formatType:"currency",height:320}),p.includes("chart-comparison")&&e.jsx(Q,{config:$,onExport:T,allowedTypes:["bar"],formatType:"currency",height:320}),p.includes("chart-category")&&e.jsx(Q,{config:B,onExport:T,allowedTypes:["pie"],formatType:"currency",height:320}),p.includes("chart-distribution")&&e.jsx(Q,{config:R,onExport:T,allowedTypes:["pie"],formatType:"currency",height:320})]}),dataTable:p.includes("table-transactions")?e.jsx(Ut,{title:"Recent Transactions",subtitle:`${E.length} transactions in selected period`,columns:Jt,data:E,enableSorting:!0,enableMultiSort:!0,enableColumnFilters:!0,enableGlobalFilter:!0,enableRowSelection:!0,enableExport:!0,enablePagination:!0,initialPageSize:10,pageSizeOptions:[10,25,50,100],getRowId:D=>D.id,onRowClick:D=>console.log("Row clicked:",D),onBatchAction:N,batchActions:[{id:"export-selected",label:"Export Selected"},{id:"mark-reviewed",label:"Mark Reviewed"},{id:"delete",label:"Delete",variant:"danger"}],exportFilename:"sales-transactions",mobileHiddenColumns:Xt,striped:!0}):null})}),d.isExporting&&e.jsxs("div",{style:{position:"fixed",bottom:24,right:24,zIndex:1080,display:"flex",alignItems:"center",gap:"var(--spacing-sm)",background:"var(--card-bg)",border:"1px solid var(--card-border-color)",borderRadius:"var(--radius-lg)",padding:"var(--spacing-md)",boxShadow:"var(--shadow-lg)",minWidth:240},children:[e.jsx(rt,{value:d.progress,size:"sm",indeterminate:d.progress<5,showLabel:!1}),e.jsx(at,{value:d.progress,size:"sm",label:`Exporting ${d.format?.toUpperCase()??""}...`,showValue:!0})]}),e.jsx(it,{isOpen:u.isOpen,onClose:h,title:u.title,description:u.description,variant:u.variant,confirmLabel:u.confirmLabel,onConfirm:u.onConfirm}),C&&e.jsx("div",{style:{position:"fixed",top:80,right:24,zIndex:1060},children:e.jsx(ra,{activeWidgetIds:p,onAddWidget:F,onRemoveWidget:W,isOpen:C,onClose:()=>y(!1)})})]})}export{wa as SalesDashboardPage,wa as default};
//# sourceMappingURL=Dashboard-C7q7H_9n.js.map
